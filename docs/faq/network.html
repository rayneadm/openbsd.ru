<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
  <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=koi8-r">
  <META HTTP-EQUIV="Content-Language" CONTENT="ru">
  <META NAME="copyright" content="Copyright (c) 2004 by OpenBSD.ru">
  <TITLE>Сеть</TITLE>
  <link rel="stylesheet" type="text/css" href="../../style.css" />
</HEAD>

<BODY>

<H2>Сеть</H2>
<HR>

<UL>
  <LI><A HREF="#dnsttl">Сделал изменения в DNS, поменял серийный номер зоны.
   Почему никто не видит изменений?</A>
  <LI><A HREF="#autoproxy">Как настроить автоконфигурацию прокси?</A>
  <LI><A HREF="#pxeboot">Почему система не грузится с сети (PXE) при
   использовании ISC DHCP сервера из портов или другой системы
   (с родным dhcpd при аналогичных настройках все работает)?</A>
</UL>
<HR>


<A NAME="dnsttl"></A>
<H3>Сделал изменения в DNS, поменял серийный номер зоны.
 Почему никто не видит изменений?</H3>

Для каждой записи зоны есть время жизни (TTL) в течение которого запись
действительна. Если оно явно не указано в файле зоны (или указано очень большим)
ранее кэшированная информация может оставаться неизменной очень долгое время.
Во избежание задержек при обновлении информации рекомендуется явно прописывать
разумное значение TTL по умолчанию в файле зоны директивой $TTL.

<A NAME="autoproxy"></A>
<H3>Как настроить автоконфигурацию прокси?</H3>

Необходимо создать файл с программой на JavaScript, реализующей функцию
FindProxyForURL и сделать его доступным по протоколу HTTP. Содержимое файла
может быть, например, таким:

<PRE>
function FindProxyForURL(url, host) {
	if (isPlainHostName(host) || dnsDomainIs(host, ".mydomain.com"))
		return "DIRECT";
	if (isInNet(host, "87.190.241.0", "255.255.255.0") ||
	    isInNet(host, "192.168.0.0", "255.255.0.0") ||
	    isInNet(host, "172.16.0.0", "255.240.0.0") ||
	    isInNet(host, "10.0.0.0", "255.0.0.0") ||
	    isInNet(host, "127.0.0.0", "255.0.0.0"))
		return "DIRECT";
	if (url.substring(0, 5) == "http:" ||
	    url.substring(0, 6) == "https:" ||
	    url.substring(0, 4) == "ftp:" ||
	    url.substring(0, 7) == "gopher:")
		return "PROXY proxy.mydomain.com:3128; DIRECT";
	return "DIRECT";
}
</PRE>

<P>
Данный пример разбирает URL и в случае если указано имя без домена, хост
в определенном домене или хост находится в опеределенной сети, соединение
не проксируется, иначе, соединение будет обслуживать прокси.

<P>
Существует два метода настройки автоматического прокси: полностью
автоматический и с указанием URL скрипта конфигурации. Предположим, что
домен для хоста клиента выглядит как
<span>office.mydomain.com</span>. В случае использования
полностью автоматического метода (доступен в Internet Explorer,
Mozilla, Firefox), браузер запрашивает файл
<span>http://wpad.office.mydomain.com/wpad.dat</span>, в
случае неудачи запрашивает файл
<span>http://wpad.mydomain.com/wpad.dat</span>, затем
<span>http://wpad.com/wpad.dat</span>. Поскольку очевидным
недостатком такого подхода является вероятность использования не того
конфигурационного файла, безопаснее задавать URL скипта конфигурации.
Для совместимости с Netscape, следует задать расширение файла <span>pac</span>, например <span>proxy.pac</span>.

<P>
Дополнительную информацию можно получить из документов
<A HREF="http://thproxy.jinr.ru/file-archive/doc/netscape/proxy-live.html">Navigator Proxy Auto-Config File Format</A> и
<A HREF="http://www.microsoft.com/resources/documentation/Windows/2000/server/reskit/en-us/ierk/Ch21_b.asp">Understanding Automatic Configuration and Automatic Proxy</A>.

<A NAME="pxeboot"></A>
<H3>Почему система не грузится с сети (PXE) при
 использовании ISC DHCP сервера из портов или другой системы
 (с родным dhcpd при аналогичных настройках все работает)?</H3>

<P>
Не указан адрес TFTP сервера в настройках. Родной dhcpd в этом случае
считает, что TFTP сервер находится на этом же хосте. В других реализациях
ISC DHCP нужно явно указывать адрес опцией <STRONG>next-server</STRONG>.

<HR>
<A HREF="../"><IMG HEIGHT="24" WIDTH="24" SRC="../../images/back.gif"
 ALT="OpenBSD.ru"></A>
<A HREF="mailto:www@openbsd.ru">www@openbsd.ru</A><BR>
<SMALL>$RuOBSD: network.html,v 1.9 2010/11/01 10:57:48 dinar Exp $</SMALL>

</BODY>
</HTML>
